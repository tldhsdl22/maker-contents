# F-006. 원고 편집 및 관리

## 1. 기능 개요

### 1.1 목적

AI가 생성한 원고를 사용자가 직접 검토하고 편집하여 최종 원고로 완성합니다. 네이버 블로그/카페에 복사-붙여넣기 했을 때 서식이 유지되는 WYSIWYG 편집기를 제공하며, 생성된 원고를 목록으로 관리합니다.

### 1.2 핵심 가치

- 네이버 편집기 호환 서식으로 복붙 시 서식 유지
- 직관적인 편집 환경으로 빠른 원고 완성
- 내 원고 목록을 통한 체계적인 작업 관리

## 2. 권한 체계

각 사용자는 자신이 생성한 원고만 조회, 편집, 삭제할 수 있습니다. 관리자는 모든 사용자의 원고를 조회할 수 있지만, 편집은 해당 원고의 생성자만 가능합니다.

## 3. 데이터 항목

### 3.1 원고 정보

- 원고 제목: 사용자가 지정하거나, 원본 기사 제목을 기반으로 자동 생성됩니다.
- 원고 본문: HTML 형태의 서식이 적용된 콘텐츠입니다.
- 포함된 이미지 목록: 원고에 사용된 이미지 파일 목록입니다.
- 원본 소스 기사 정보: 어떤 기사를 기반으로 생성했는지 기록합니다.
- 생성 설정: 사용한 프롬프트, 이미지 템플릿, 키워드, 글 길이 정보입니다.

### 3.2 시스템 관리 정보

- 생성 일시, 최종 수정 일시
- 원고 상태: 생성 완료, 포스팅 완료

## 4. 상세 기능 명세

### 4.1 WYSIWYG 편집기

네이버 블로그/카페 편집기와 호환되는 서식을 지원하는 편집기를 제공합니다.

접근 권한: 원고 생성자만 편집할 수 있습니다.

지원하는 서식:
- 글자 크기 조절
- 글자 색상 변경
- 굵기 (Bold)
- 기울기 (Italic)
- 취소선 (Strikethrough)
- 텍스트 정렬 (좌측, 중앙, 우측)
- 인용구
- 링크 삽입
- 이미지 삽입 및 위치 변경

동작 방식:
1. AI가 생성한 원고가 편집기에 로드됩니다.
2. 사용자는 텍스트를 직접 수정할 수 있습니다. 텍스트 선택 후 서식 도구를 적용합니다.
3. 이미지를 클릭하여 선택하면 삭제, 교체 옵션이 표시됩니다.
4. 이미지 위치를 드래그하여 변경할 수 있습니다.
5. 편집기 도구 모음에서 "이미지 추가" 버튼으로 새 이미지를 삽입할 수 있습니다. 이미지 삽입 시 파일 업로드 또는 AI 이미지 생성 중 선택합니다.
6. 편집 내용은 자동 저장되거나, "저장" 버튼으로 수동 저장합니다.

표시 규칙:
- 편집기 상단에 서식 도구 모음을 배치합니다.
- 편집 영역은 실제 포스팅될 형태와 유사하게 보여줍니다(WYSIWYG).
- 복사 버튼을 제공하여 원고 전체를 클립보드에 복사할 수 있습니다. 복사 시 HTML 서식이 포함되어 네이버 편집기에 붙여넣기 했을 때 서식이 유지됩니다.

### 4.2 내 원고 목록

사용자가 자신의 원고를 목록으로 관리합니다.

접근 권한: 각 사용자는 자신의 원고만 볼 수 있습니다. 관리자는 전체 사용자의 원고를 조회할 수 있습니다.

동작 방식:
1. 내 원고 목록을 최신순으로 표시합니다.
2. 각 항목에 원고 제목, 상태(생성 완료/포스팅 완료), 생성일, 사용한 프롬프트명을 표시합니다.
3. 원고를 클릭하면 편집 화면으로 이동합니다.
4. 삭제 버튼으로 원고를 삭제할 수 있습니다. 삭제 시 확인 다이얼로그를 표시합니다.

표시 규칙:
- 상태별 필터를 제공합니다. (전체, 생성 완료, 포스팅 완료)
- 포스팅 완료된 원고에는 등록된 URL을 함께 표시합니다.

### 4.3 원고 삭제

사용자가 불필요한 원고를 삭제합니다.

동작 방식:
1. 삭제 버튼을 클릭하면 "이 원고를 삭제하시겠습니까?"라는 확인 다이얼로그를 표시합니다.
2. 확인 시 원고와 관련된 이미지 파일을 모두 삭제합니다.
3. 포스팅 완료 상태의 원고도 삭제할 수 있습니다. 단, 성과 추적 데이터는 별도로 보관됩니다.

## 5. 화면 정보

### S-011 원고 편집 페이지

상단에 서식 도구 모음(크기, 색상, 굵기, 기울기, 취소선, 정렬, 인용구, 링크, 이미지)을 배치합니다. 중앙에 WYSIWYG 편집 영역을 배치합니다. 우측 상단에 "복사", "저장", "포스팅" 버튼을 배치합니다.

### S-012 내 원고 목록 페이지

상단에 상태별 필터 탭을 배치합니다. 원고 목록을 리스트 형태로 표시하며, 각 항목에 제목, 상태, 생성일, 프롬프트명을 표시합니다. 각 항목에 편집, 삭제 버튼을 표시합니다.

## 6. API 정보

- GET /api/manuscripts: 내 원고 목록 조회 (상태 필터, 페이지네이션)
- GET /api/manuscripts/:id: 원고 상세 조회 (편집기 데이터)
- PUT /api/manuscripts/:id: 원고 수정 (편집기 내용 저장)
- DELETE /api/manuscripts/:id: 원고 삭제
- POST /api/manuscripts/:id/copy: 원고 클립보드 복사용 HTML 반환
- GET /api/admin/manuscripts: 전체 원고 목록 조회 (관리자)

## 7. 비즈니스 로직

- 편집기에서 복사 시 네이버 블로그/카페 편집기에서 인식 가능한 HTML 형태로 클립보드에 저장합니다.
- 이미지는 서버에 저장된 URL로 포함됩니다. 네이버에 붙여넣기 시 이미지가 정상적으로 표시되려면, 이미지 URL이 외부에서 접근 가능해야 합니다.
- 자동 저장은 편집 후 일정 시간(예: 30초) 동안 추가 편집이 없으면 자동으로 저장합니다.

## 8. 연관 기능

- F-005 원고 생성: 생성된 원고를 편집기에 로드합니다.
- F-007 포스팅 관리: 편집 완료 후 포스팅 처리를 수행합니다.
