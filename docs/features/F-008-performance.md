# F-008. 성과 추적

## 1. 기능 개요

### 1.1 목적

포스팅된 콘텐츠의 성과를 자동으로 추적합니다. 네이버 검색에서의 키워드 순위, 게시글의 조회수, 댓글 수를 주기적으로 수집하여 포스팅의 효과를 측정합니다.

### 1.2 핵심 가치

- 포스팅 성과를 데이터 기반으로 객관적 측정
- 키워드 순위 변동 추이를 통한 SEO 전략 수립
- 효과적인 프롬프트/스타일 파악을 통한 콘텐츠 품질 개선

## 2. 권한 체계

각 사용자는 자신의 포스팅에 대한 성과 데이터를 조회할 수 있습니다. 관리자는 전체 사용자의 성과 데이터를 조회할 수 있습니다.

## 3. 데이터 항목

### 3.1 추적 데이터

포스팅 완료 후 7일간 1시간 간격으로 다음 데이터를 수집합니다.

- 키워드 순위: 네이버 검색(블로그 탭 또는 카페 탭)에서 해당 키워드로 검색했을 때의 순위입니다. 플랫폼(블로그/카페)에 따라 해당 탭에서 순위를 확인합니다.
- 조회수: 게시글의 현재 조회수입니다.
- 댓글 수: 게시글의 현재 댓글 수입니다.
- 수집 일시: 데이터를 수집한 시점입니다.

### 3.2 시스템 관리 정보

- 추적 시작일: 포스팅 완료 처리 시점입니다.
- 추적 종료일: 시작일 + 7일입니다.
- 추적 상태: 추적 중, 추적 완료

## 4. 상세 기능 명세

### 4.1 자동 성과 수집

포스팅 완료 처리된 원고의 성과를 자동으로 수집합니다.

동작 방식:
1. 포스팅 완료 처리(F-007) 시 성과 추적이 자동으로 시작됩니다.
2. 1시간 간격으로 다음을 수행합니다:
   - 네이버 검색에서 등록된 키워드로 검색하여 해당 포스팅의 순위를 확인합니다.
   - 포스팅 URL에 접근하여 조회수와 댓글 수를 크롤링합니다.
3. 수집된 데이터를 시간별로 기록합니다.
4. 7일이 경과하면 추적을 종료합니다.

예외 처리:
- 포스팅이 삭제되어 URL에 접근할 수 없는 경우, 해당 수집 건에 "접근 불가"를 기록하고 추적을 계속합니다.
- 키워드 검색 결과에 해당 포스팅이 없는 경우, 순위를 "순위권 외"로 기록합니다.
- 크롤링에 실패한 경우, 다음 주기에 재시도합니다.

### 4.2 성과 데이터 조회

사용자가 자신의 포스팅 성과를 확인합니다.

접근 권한: 각 사용자는 자신의 포스팅 성과를, 관리자는 전체 포스팅 성과를 조회할 수 있습니다.

동작 방식:
1. 내 원고 목록에서 포스팅 완료된 항목에 간단한 성과 요약을 표시합니다.
   - 최신 키워드 순위, 현재 조회수, 댓글 수를 표시합니다.
2. 원고를 클릭하면 상세 성과 페이지에서 시간별 추이를 확인할 수 있습니다.
   - 키워드 순위 변동 그래프
   - 조회수 변동 그래프
   - 댓글 수 변동 그래프

## 5. 화면 정보

### S-013 성과 상세 페이지

상단에 현재 순위, 총 조회수, 총 댓글 수를 요약 카드로 표시합니다. 하단에 시간별 추이 그래프(키워드 순위, 조회수, 댓글 수)를 표시합니다. 추적 기간(7일)과 현재 진행 상황을 표시합니다.

## 6. API 정보

- GET /api/manuscripts/:id/performance: 성과 데이터 조회 (시간별 추이)
- GET /api/manuscripts/:id/performance/summary: 성과 요약 조회 (최신 순위, 조회수, 댓글 수)

## 7. 비즈니스 로직

- 성과 추적은 포스팅 완료 처리 시 자동으로 시작되며, 별도의 사용자 조작이 필요 없습니다.
- 추적 주기: 1시간 간격으로 데이터를 수집합니다.
- 추적 기간: 포스팅 완료 후 7일간 진행됩니다.
- 원고를 삭제하면 성과 추적이 중단되고 수집된 데이터도 삭제됩니다.
- 키워드 순위 확인은 네이버 검색 기준이며, 블로그 포스팅은 블로그 탭에서, 카페 포스팅은 카페 탭에서 순위를 확인합니다.

## 8. 연관 기능

- F-007 포스팅 관리: 포스팅 완료 시 성과 추적이 시작됩니다.
- F-009 대시보드: 성과 요약 데이터를 대시보드에서 표시합니다.
