# F-004. 이미지 처리 템플릿 관리

## 1. 기능 개요

### 1.1 목적

원고에 사용되는 이미지의 가공 방식을 관리자가 정의합니다. 원본 기사에 포함된 이미지를 가공하는 방식과, 새로 생성하는 이미지의 생성 방식을 각각 정의하여, 사용자가 원고 생성 시 원하는 이미지 처리 방식을 선택할 수 있도록 합니다.

### 1.2 핵심 가치

- 이미지 저작권 이슈를 회피하기 위한 다양한 가공 옵션 제공
- 콘텐츠 스타일에 맞는 이미지 일관성 유지
- 이미지 처리 방식의 중앙 관리를 통한 품질 통제

## 2. 권한 체계

이미지 처리 템플릿의 생성, 수정, 삭제는 관리자만 수행할 수 있습니다. 일반 사용자는 원고 생성 시 템플릿 목록을 조회하고 선택만 할 수 있습니다.

## 3. 데이터 항목

### 3.1 기본 정보

- 템플릿명: 사용자가 식별할 수 있는 이름입니다. 예: "원본 유사 변환", "2D 일러스트", "색상 변환"
- 설명: 이미지가 어떻게 처리되는지에 대한 간략한 설명입니다.
- 원본 이미지 처리 프롬프트 (필수): 기사에 포함된 원본 이미지를 가공할 때 이미지 AI에 전달할 프롬프트입니다. 관리자가 자유롭게 작성합니다.
- 신규 이미지 생성 프롬프트 (선택): 이미지가 부족할 때 새로 생성할 이미지의 프롬프트입니다. 이미지 생성 AI(나노바나나)에게 전달됩니다.
- 워터마크 제거 여부: 활성화 시 원본 이미지 처리 프롬프트에 워터마크 제거 지시가 자동으로 추가됩니다.
- 사용 여부: 활성화/비활성화 상태입니다.

### 3.2 시스템 관리 정보

- 생성일, 수정일
- 생성자(관리자 아이디)

## 4. 상세 기능 명세

### 4.1 이미지 처리 템플릿 생성

관리자가 새로운 이미지 처리 템플릿을 등록합니다.

접근 권한: 관리자만 사용할 수 있습니다.

동작 방식:
1. 템플릿명, 설명을 입력합니다.
2. 원본 이미지 처리 프롬프트를 작성합니다. (필수)
3. 필요 시 신규 이미지 생성 프롬프트를 작성합니다. (선택)
4. 워터마크 제거 여부를 설정합니다. (활성화 시 프롬프트에 자동 추가)
5. 저장 시 기본적으로 활성화 상태로 등록됩니다.

### 4.2 이미지 처리 템플릿 수정

관리자가 기존 템플릿의 내용을 수정합니다. 수정해도 이미 생성된 원고의 이미지에는 영향을 주지 않습니다.

### 4.3 이미지 처리 템플릿 비활성화/삭제

비활성화 시 사용자의 선택 목록에서 숨겨집니다. 삭제 시 완전히 제거됩니다.

## 5. 화면 정보

### S-007 이미지 처리 템플릿 관리 페이지 (관리자)

템플릿 목록을 리스트 형태로 표시합니다. 각 항목에 템플릿명, 설명, 처리 방식 요약, 상태를 표시합니다.

### S-008 이미지 처리 템플릿 편집 페이지 (관리자)

템플릿명, 설명, 원본 이미지 처리 프롬프트 입력, 신규 이미지 생성 프롬프트 입력, 워터마크 제거 토글로 구성됩니다.

## 6. API 정보

- GET /api/image-templates: 이미지 처리 템플릿 목록 조회
- GET /api/image-templates/:id: 이미지 처리 템플릿 상세 조회
- POST /api/admin/image-templates: 템플릿 생성 (관리자)
- PUT /api/admin/image-templates/:id: 템플릿 수정 (관리자)
- PATCH /api/admin/image-templates/:id/toggle: 활성화/비활성화 (관리자)
- DELETE /api/admin/image-templates/:id: 템플릿 삭제 (관리자)

## 7. 비즈니스 로직

- 이미지 생성 AI는 현재 나노바나나를 사용하되, 추후 교체 가능하도록 추상화 레이어를 둡니다.
- 원본 이미지 처리와 신규 이미지 생성은 독립적인 설정입니다. 하나의 템플릿에서 두 가지를 모두 정의합니다.

## 8. 연관 기능

- F-005 원고 생성: 사용자가 이미지 처리 템플릿을 선택하여 원고를 생성합니다.
- F-003 프롬프트 관리: 프롬프트와 이미지 처리 템플릿을 조합하여 최종 원고를 생성합니다.
